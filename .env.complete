# =====================================================================
# Vanna Insight Engine - Complete Environment Template
# ---------------------------------------------------------------------
# This file enumerates every supported environment variable, the default
# value used by the backend/frontend, and (when applicable) the allowed
# options. Copy what you need into your own .env/.env.dev/.env.prod
# files and customize safely.
# =====================================================================

# ---------------------------------------------------------------------
# 1. Core Application Metadata
# ---------------------------------------------------------------------
# Human-friendly service name. Default: vanna-insight-engine
APP_NAME=vanna-insight-engine

# Environment label for logs and config branching.
# Default: development | Options: development, staging, production, test
APP_ENV=development

# Enable verbose logging, debug routes, and relaxed auth in dev.
# Default: false | Options: true, false
DEBUG=false

# API version prefix (rarely changed). Default: /api/v1
API_V1_PREFIX=/api/v1

# ---------------------------------------------------------------------
# 2. Server Runtime
# ---------------------------------------------------------------------
# Bind address for FastAPI/Uvicorn. Default: 0.0.0.0
HOST=0.0.0.0

# HTTP port to expose. Default: 8000
PORT=8000

# Number of Uvicorn/Gunicorn worker processes (ignored in DEBUG mode).
# Default: 4
WORKERS=4

# ---------------------------------------------------------------------
# 3. Primary Database Configuration (System DB)
# ---------------------------------------------------------------------
# Primary database type powering SQLAlchemy.
# Default: sqlite | Options: sqlite, postgresql, mssql, oracle
DB_TYPE=sqlite

# Fully-qualified SQLAlchemy URL for PostgreSQL (overrides POSTGRES_*).
# Default: empty (auto-built when blank)
POSTGRES_URL=

# Legacy alias for compatibility. Leave blank unless overriding.
# Default: empty (auto-synced with POSTGRES_URL)
DATABASE_URL=

# Direct credentials used when building URLs automatically.
DB_USER=
DB_PASSWORD=

# SQLAlchemy pool tuning. Defaults: 20 connections, +10 overflow.
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10

# SQLite path used when DB_TYPE=sqlite. Default: vanna_db.db
SQLITE_DB_PATH=vanna_db.db

# PostgreSQL connection pieces used when POSTGRES_URL is blank.
POSTGRES_HOST=postgres
POSTGRES_PORT=5432
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_DB=vanna_db

# Optional MSSQL connector
MSSQL_HOST=localhost
MSSQL_PORT=1433
MSSQL_USER=sa
MSSQL_PASSWORD=
MSSQL_DB=vanna_db
# Default driver: "ODBC Driver 18 for SQL Server"
MSSQL_DRIVER=ODBC Driver 18 for SQL Server

# Optional Oracle connector
ORACLE_HOST=localhost
ORACLE_PORT=1521
ORACLE_USER=dev_user
ORACLE_PASSWORD=dev_pass
# Provide either SERVICE_NAME or SID (leave the other blank)
ORACLE_SERVICE_NAME=
ORACLE_SID=
# Optional EZConnect-style DSN (e.g., host:port/service). Overrides host/port/service when set.
ORACLE_DSN=localhost:1521/FREEPDB1

# ---------------------------------------------------------------------
# 4. Redis / Caching / Rate Limiting
# ---------------------------------------------------------------------
# Primary Redis URL for caching + session use. Default: redis://redis:6379/0
REDIS_URL=redis://redis:6379/0

# Legacy host-only override (only set when needed). Default: empty
REDIS_HOST=

# Password injected into Redis URLs when provided. Default: empty
REDIS_PASSWORD=

# Cache TTL for common lookups (seconds). Default: 3600
REDIS_CACHE_TTL=3600

# Global request-rate limit bucket (per IP). Default: 100 requests/60s
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60

# Public SQL endpoints (unauthenticated) limit. Default: 100/hour
PUBLIC_SQL_RATE_LIMIT=100/hour

# Storage URI used by SlowAPI (defaults to REDIS_URL). Example: redis://...
RATE_LIMIT_STORAGE_URI=redis://redis:6379/0

# ---------------------------------------------------------------------
# 5. Query Execution Limits
# ---------------------------------------------------------------------
# Default database timeout in seconds. Default: 30
QUERY_TIMEOUT_SECONDS=30

# Maximum rows allowed per query. Default: 10000
QUERY_MAX_LIMIT=10000

# ---------------------------------------------------------------------
# 6. Background Tasks / Celery
# ---------------------------------------------------------------------
# Celery broker / result backend (defaults target dedicated Redis DBs).
CELERY_BROKER_URL=redis://redis:6379/1
CELERY_RESULT_BACKEND=redis://redis:6379/2

# ---------------------------------------------------------------------
# 7. Monitoring & Observability
# ---------------------------------------------------------------------
# Toggle built-in Prometheus metrics, OpenTelemetry tracing, structured logs.
ENABLE_METRICS=true
ENABLE_TRACING=false
ENABLE_LOGGING=true

# Optional Sentry integration (leave blank to disable).
SENTRY_DSN=
# Sampling rate for Sentry traces (0.0-1.0). Default: 0.1
SENTRY_TRACES_SAMPLE_RATE=0.1
# Label to report to Sentry. Default mirrors APP_ENV
SENTRY_ENVIRONMENT=development

# OpenTelemetry endpoint + headers if emitting OTLP spans.
OTLP_ENDPOINT=
OTLP_HEADERS=
# Whether to skip TLS validation when sending to OTLP. Default: false
OTLP_INSECURE=false

# ---------------------------------------------------------------------
# 8. Authentication & Security
# ---------------------------------------------------------------------
# Application secret key for sessions + CSRF. Default: generated at runtime
SECRET_KEY=CHANGE_ME

# JWT signing settings.
JWT_ALGORITHM=HS256
JWT_EXPIRATION_HOURS=24
JWT_SECRET_KEY=CHANGE_ME_TOO

# Optional cookie name to mirror Authorization header in the Vanna Agent UI.
AUTH_COOKIE_NAME=

# Comma-separated list of allowed origins for CORS.
CORS_ORIGINS=http://localhost,http://localhost:3000,http://localhost:8000,http://localhost:8501

# ---------------------------------------------------------------------
# 9. LLM Provider Selection
# ---------------------------------------------------------------------
# Primary LLM route (determines helper defaults below).
# Default: ollama | Options: openai, anthropic, google, ollama, azure-openai
LLM_PROVIDER=ollama

# OpenAI settings
OPENAI_API_KEY=
OPENAI_MODEL_NAME=gpt-3.5-turbo

# --- Groq Settings ---
GROQ_API_KEY=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
GROQ_MODEL=llama3-70b-8192

# Anthropic (Claude) settings
ANTHROPIC_API_KEY=
ANTHROPIC_MODEL_NAME=claude-opus-4

# Google Generative AI (Gemini) settings
GOOGLE_API_KEY=
GOOGLE_MODEL_NAME=gemini-1.5-pro

# Ollama (self-hosted models) settings
OLLAMA_BASE_URL=http://10.10.10.1:1234
OLLAMA_MODEL_NAME=gemma-3n

# --- Local Gemma Server ---
LOCAL_GEMMA_MODEL=gemma-3n
LOCAL_GEMMA_HOST=http://10.10.10.1:1234

# Azure OpenAI deployment parameters
AZURE_OPENAI_ENDPOINT=
AZURE_OPENAI_API_KEY=
AZURE_OPENAI_DEPLOYMENT=
AZURE_OPENAI_MODEL_NAME=
AZURE_OPENAI_API_VERSION=2024-12-01-preview

# ---------------------------------------------------------------------
# 10. Vanna OSS / Agent Configuration
# ---------------------------------------------------------------------
# API key + model ID used by legacy Vanna OSS helpers.
VANNA_API_KEY=
VANNA_MODEL_ID=

# CDN URL for the web component bundle used by /vanna/ UI.
VANNA_COMPONENT_CDN=https://img.vanna.ai/vanna-components.js

# Feature flag to mount the FastAPI Vanna Agent server. Default: true
FEATURE_VANNA_ENABLED=true

# ---------------------------------------------------------------------
# 11. Vector Database Backends
# ---------------------------------------------------------------------
# Vector DB type. Default: chroma | Options: chroma, qdrant, pinecone, etc.
VECTOR_DB_TYPE=chroma

# Local Chroma service (host/port).
CHROMA_HOST=chromadb
CHROMA_PORT=8000

# Qdrant settings.
QDRANT_HOST=localhost
QDRANT_PORT=6333

# ---------------------------------------------------------------------
# 12. Feature Flags
# ---------------------------------------------------------------------
FEATURE_CACHE_ENABLED=true
FEATURE_FEEDBACK_LOOP=true

# ---------------------------------------------------------------------
# 13. dbt / Semantic Layer / Governance
# ---------------------------------------------------------------------
DBT_PROJECT_PATH=dbt_project
DBT_PROFILE_NAME=vanna_engine

SEMANTIC_MODEL_DIR=ontology/semantic_models
SEMANTIC_REFRESH_SECONDS=900
METRICS_REGISTRY_PATH=ontology/metrics.yaml
ENABLE_SEMANTIC_COMPILER=true
ENABLE_ROW_LEVEL_SECURITY=true
ENABLE_COLUMN_LEVEL_SECURITY=true
POLICY_CACHE_SECONDS=300
DASHBOARD_ADAPTER=superset
DASHBOARD_PREVIEW_TTL=3600
SPREADSHEET_MAX_CELLS=10000
SPREADSHEET_SANDBOX_BUCKET=
USAGE_RETENTION_DAYS=30
GOVERNANCE_WEBHOOK_URL=

# ---------------------------------------------------------------------
# 14. Golden Copy / Target Database
# ---------------------------------------------------------------------
# Optional read-only analytical DB to sync with.
TARGET_DATABASE_URL=
ENABLE_TARGET_DB=false

# Golden-copy seed file + runtime path for SQLite backups.
TARGET_DB_SOURCE=assets/databases/vanna_db.db
TARGET_DB_PATH=/app/data/vanna_db.db

# Automatically train Chroma using target DB when enabled.
AUTO_TRAIN_CHROMA=false

# ---------------------------------------------------------------------
# 15. Seed Data & Default Admin Account
# ---------------------------------------------------------------------
# Populate demo data on first run. Default: true
SEED_DEMO_DATA=true

# Initial admin credentials injected by scripts/init_project.py
INIT_ADMIN_USERNAME=admin
INIT_ADMIN_PASSWORD=admin
INIT_ADMIN_RECOVERY_EMAIL=

# ---------------------------------------------------------------------
# 16. Backup & Recovery
# ---------------------------------------------------------------------
# Root directory where backup artifacts are stored. Default: backups
BACKUP_DIR=backups

# Number of backups to keep before pruning. Default: 7
BACKUP_RETENTION_COUNT=7

# ---------------------------------------------------------------------
# 17. Secret Management / Cloud Providers
# ---------------------------------------------------------------------
CLOUD_PROVIDER=aws
AWS_REGION=us-east-1
AZURE_KEYVAULT_URL=
GCP_PROJECT_ID=

# ---------------------------------------------------------------------
# 18. Streamlit Frontend (ui_streamlit_agent)
# ---------------------------------------------------------------------
# URL of the FastAPI backend to call.
BACKEND_URL=http://api:8000

# HTTP timeout (seconds) for frontend API calls. Default: 30
API_TIMEOUT_SECONDS=30

# Enable additional logging / relaxed redirect behavior in Streamlit.
DEBUG=false

# Optional default credentials (helpful for demo sandboxes).
DEFAULT_USERNAME=admin
DEFAULT_PASSWORD=admin

# ---------------------------------------------------------------------
# 19. Miscellaneous
# ---------------------------------------------------------------------
# Override the env file used by pydantic-settings (rarely used).
ENV_FILE=.env

# Place any future overrides below. Keep comments describing defaults
# and permitted values so deployments remain self-documenting.
